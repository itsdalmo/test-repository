jobs:
  - name: test
    plan:
    - get: test-pull-request
      trigger: true
      version: every
    - put: test-pull-request
      params:
        path: test-pull-request
        context: build
        status: pending
    - task: placeholder
      config:
        platform: linux
        image_resource:
          type: docker-image
          source: {repository: alpine, tag: "3.5"}
        inputs:
          - name: test-pull-request
        run:
          path: /bin/sh
          args:
            - -xce
            - |
              sleep 30
              ls -la test-pull-request
    - put: test-pull-request
      params:
        path: test-pull-request
        context: build
        status: success

resource_types:
  - name: pull-request
    type: docker-image
    source:
      repository: itsdalmo/github-pr-resource

resources:
  - name: test-pull-request
    type: pull-request
    source:
      repository: itsdalmo/test-repository
      context: concourse-ci/status
      access_token: ((github-access-token))
